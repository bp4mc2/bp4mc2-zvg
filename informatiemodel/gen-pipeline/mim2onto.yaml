title: MIM conversie
version: 0.1
queries:
  - title: create technical names
    query: >
      PREFIX mim: <http://bp4mc2.org/def/mim#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      INSERT {
        GRAPH <urn:input> {
          ?item skos:notation ?codefixed
        }
      }
      WHERE {
        GRAPH <urn:input> {
          ?item mim:naam ?naam
          BIND (replace(?naam,"[^a-zA-Z0-9_-]","_") as ?codefixed)
        }
      }
  - title: convert mim:Objecttype
    query: >
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      PREFIX mim: <http://bp4mc2.org/def/mim#>
      PREFIX sh: <http://www.w3.org/ns/shacl#>
      INSERT {
        GRAPH <urn:output> {
          ?class a owl:Class, sh:NodeShape.
          ?class sh:targetClass ?class.
          ?class rdfs:label ?naam.
          ?class sh:name ?code.
          ?class rdfs:seeAlso ?objecttype.
        }
      }
      WHERE {
        SELECT (iri(concat("http://test/def#",?code)) as ?class) ?code ?naam ?objecttype
        WHERE {
          GRAPH <urn:input> {
            ?objecttype a mim:Objecttype.
            ?objecttype mim:naam ?naam.
            ?objecttype skos:notation ?code.
          }
        }
      }
